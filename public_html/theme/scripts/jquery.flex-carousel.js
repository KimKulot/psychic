;(function($,t){$.fn.extend({flexCarousel:function(q){var r={showItems:4,itemWidthRangeConflict:"margin",rangeCalculate:"maxFirst",pagination:true,navigation:false,navigationText:["Prev","Next"],itemLess:"margin",scrollPerPage:false,rewind:true,pauseOnHover:true,drag:true,mouseWheel:false,autoPlay:false,interval:3000,themeClass:"flex-theme-default",slideSpeed:400,responsiveSpeed:400,scrollPageSpeed:600,responsive:true,responsiveMode:"breakPoints",responsiveBaseOn:window,responsiveDelay:200,breakPoints:[[480,1],[768,2],[992,3],[1200,4]],itemWidthRange:[100,400],itemAnimation:false,lazyLoad:false,beforeInit:null,afterInit:null,beforeUpdate:null,afterUpdate:null,indexChanged:null,beforeDrag:null,afterDrag:null};var q=$.extend({},r,q);function FlexCarousel(a,b){this.container=a;this.container.data("flexCarousel",this);this.opt=b;this.init()}FlexCarousel.prototype={init:function(){if($.isFunction(this.opt.beforeInit)){this.opt.beforeInit()}this.getBrowserStatus();this.initMainVars();this.buildWrap();this.updateUI(false);this.wrapper.css("display","block");this.loadEvents();if(this.opt.autoPlay){this.play()}if($.isFunction(this.opt.afterInit)){this.opt.afterInit()}if(this.needCheckVisible){this.checkVisible(0)}},getBrowserStatus:function(){var e=this;this.isTouch=Modernizr.touch;this.transform3d=Modernizr.csstransforms3d;this.transform2d=Modernizr.csstransforms;this.transition=Modernizr.csstransitions;this.cssanimations=Modernizr.cssanimations;if(this.transition){var f={"WebkitTransition":"webkitTransitionEnd","MozTransition":"transitionend","OTransition":"oTransitionEnd otransitionend","transition":"transitionend"};this.transitionName=Modernizr.prefixed("transition");this.transEndName=f[Modernizr.prefixed("transition")];this.emulateTransitionEnd=function(a,b){var c=false;a.one(e.transEndName,function(){c=true});var d=function(){if(!c)a.trigger(e.transEndName)};window.setTimeout(d,b)};this.moveProperty=Modernizr.prefixed("transform");if(this.transform3d){this.moveValueMarkup="translate3d({0}px,0px,0px)"}else{this.moveValueMarkup="translate({0}px,0px)"}}else{this.moveProperty="left";this.moveValueMarkup="{0}px"}},initMainVars:function(){if(window.flexId==t){window.flexId=0}this.internalId=window.flexId+1;this.items=this.container.children();this.itemTotal=this.items.length;this.visibleItemCount=this.opt.showItems;this.showIndex=0;this.activeIndex=0;this.itemPad=0;this.pageIndex=-1;this.isSliding=false;this.dragging=false;this.playStatus="stop";this.doAnimation=this.cssanimations&&this.opt.itemAnimation!=false;this.needCheckVisible=this.doAnimation||this.opt.lazyLoad;if(this.opt.lazyLoad){this.lazyImages=this.container.find(".img-lazy[data-src]")}},buildWrap:function(){var b=this;this.originalClass=this.container.attr("class")||"";this.container.addClass("flex-carousel");if(this.opt.themeClass!=""&&!this.container.hasClass(this.opt.themeClass)){this.container.addClass(this.opt.themeClass)}this.items.wrapAll('<div class="flex-wrapper"></div>').wrap('<div class="flex-item"></div>');this.flexItems=this.container.find(".flex-item");this.wrapper=this.container.find(".flex-wrapper").wrap('<div class="flex-wrapper-holder"></div>');this.wrapperHolder=this.container.find(".flex-wrapper-holder");this.container.css("display","block");if(this.opt.pagination){this.pagination=$('<div class="flex-pagination"></div>').appendTo(this.container);this.pagination.on("click.flex touchend",".flex-page",function(){var a=$(this).data("flexIndex");if(b.showIndex!=a){b.goTo(a,b.opt.scrollPageSpeed,true)}})}if(this.opt.navigation){this.navigation=$('<div class="flex-navigation"></div>').appendTo(this.container);this.previousBtn=$('<div class="flex-prev">'+this.opt.navigationText[0]+'</div>').appendTo(this.navigation);this.nextBtn=$('<div class="flex-next">'+this.opt.navigationText[1]+'</div>').appendTo(this.navigation);this.previousBtn.on("click.flex",function(){b.prev()});this.nextBtn.on("click.flex",function(){b.next()})}},calculateResponsiveItems:function(){var c=1,pad=0,minWidth,maxWidth;var d=$(this.opt.responsiveBaseOn).width();var e=this.wrapperHolder.innerWidth();this.holderWidth=e;if(this.opt.responsive){if(this.opt.responsiveMode=="itemWidthRange"){var f;f=this.opt.itemWidthRange.sort();minWidth=f[0];maxWidth=f[1];var g=e/minWidth;var h=e/maxWidth;if(this.opt.rangeCalculate==="minFirst"){c=Math.floor(g);if(c>0){if(c<h){if(this.opt.itemWidthRangeConflict!=="adjust"){pad=e/c-maxWidth}}}else{c=1}}else if(this.opt.rangeCalculate==="maxFirst"){c=Math.ceil(h);if(c>g){c-=1;if(c>0){if(this.opt.itemWidthRangeConflict!=="adjust"){pad=e/c-maxWidth}}else{c=1}}}}else{var j=this.opt.breakPoints.sort(function(a,b){return b[0]-a[0]});c=this.opt.showItems>j[0][1]?this.opt.showItems:j[0][1];for(var i=0;i<j.length;i++){if(d<=j[i][0]){c=j[i][1]}else{break}}}if(c>this.itemTotal){if(this.opt.responsiveMode==="breakPoints"){if(this.opt.itemLess==="margin"){pad=e/this.itemTotal-e/c;c=this.itemTotal}else if(this.opt.itemLess==="scaleUp"){c=this.itemTotal}}if(this.opt.responsiveMode==="itemWidthRange"){if(this.opt.itemLess==="margin"){if(this.opt.rangeCalculate==="minFirst"){if(h>this.itemTotal){c=this.itemTotal;pad=e/c-maxWidth}else{c=this.itemTotal;pad=0}}if(this.opt.rangeCalculate==="maxFirst"){c=this.itemTotal;pad=e/c-maxWidth}}if(this.opt.itemLess==="scaleUp"){c=this.itemTotal;pad=0}}}}else{c=this.opt.showItems}this.visibleItemCount=c;this.itemPad=pad;this.itemWidth=e/c},calculatePositionArray:function(){this.itemPositions=[];this.pagePositions=[];this.userItemPositions=[];this.pageIndexs=[];var a=this.itemTotal-this.visibleItemCount;var b=0;for(var i=0;i<this.itemTotal;i++){this.itemPositions.push(this.itemWidth*i*-1);this.userItemPositions.push(this.itemPositions[i]-this.itemPad/2);if((i%this.visibleItemCount==0&&i<a)||i==a){b++;this.pagePositions.push(this.itemPositions[i]);this.pageIndexs.push(i)}this.flexItems.eq(i).data("page",b)}},updatePagination:function(){if(this.opt.pagination){this.pagination.empty().hide();if(this.pagePositions.length>1){this.pagination.show();for(var i=0;i<this.pagePositions.length;i++){$('<div class="flex-page"><span> </span></div>').data('flexIndex',$.inArray(this.pagePositions[i],this.itemPositions)).appendTo(this.pagination)}}}},checkPagination:function(){if(this.opt.pagination){for(var i=0;i<this.pageIndexs.length;i++){if(this.showIndex>=this.pageIndexs[i]){pageIndex=i}else{break}}this.pagination.find(".active-page").removeClass("active-page");this.pagination.find(".flex-page").eq(pageIndex).addClass("active-page");this.pageIndex=pageIndex}},checkNavigation:function(){if(!this.opt.rewind&&this.opt.navigation){this.previousBtn.removeClass("flex-disable");this.nextBtn.removeClass("flex-disable");if(!this.showIndex){if(!this.previousBtn.hasClass("flex-disable")){this.previousBtn.addClass("flex-disable")}}if(this.showIndex==this.maxTransItems){if(!this.nextBtn.hasClass("flex-disable")){this.nextBtn.addClass("flex-disable")}}}},maxTrans:function(){if(this.visibleItemCount>this.itemTotal){this.maxTransLeft=0;this.maxTransItems=0}else{this.maxTransLeft=(this.itemTotal-this.visibleItemCount)*this.itemWidth;this.maxTransItems=this.itemTotal-this.visibleItemCount}},updateUI:function(c){var d=this;if($.isFunction(this.opt.beforeUpdate)){this.opt.beforeUpdate()}this.calculateResponsiveItems();this.maxTrans();this.calculatePositionArray();this.updatePagination();this.checkPagination();this.checkNavigation();var e=this.itemPad;var f=this.visibleItemCount;var g=this.itemWidth;var h=this.wrapper.width();var i=g*this.itemTotal*2;if(c){var j=function(){};if(h<=i){this.wrapper.width(i);j=function(){d.goTo(d.showIndex,d.opt.slideSpeed,true)}}else{j=function(){d.wrapper.width(i);d.goTo(d.showIndex,d.opt.slideSpeed,true)}}var k;if(this.transition){this.wrapper.css(this.transitionName,"")}$.when(this.flexItems.stop(true,false).animate({"width":g-e,"marginLeft":e/2,"marginRight":e/2},{duration:this.opt.responsiveSpeed,step:function(a,b){if(true){if(b.prop=="width"){k=a}if(b.prop=="marginLeft"){k+=a*2;d.moveTo(-d.showIndex*k)}}}})).then(function(){if($.isFunction(d.opt.afterUpdate)){d.opt.afterUpdate()}j()})}else{this.wrapper.width(i);this.flexItems.css({"width":g-e,"marginLeft":e/2,"marginRight":e/2});if($.isFunction(this.opt.afterUpdate)){this.opt.afterUpdate()}}this.resumePlay()},resizeHandler:function(){var b=this;var c=$(window).width();var d;this.doRezise=function(){if($(window).width()!=c){window.clearTimeout(d);b.clearPlay();d=window.setTimeout(function(){var a=$(window).width();if(c!=a){c=a;b.updateUI(true)}},b.opt.responsiveDelay)}};if(this.opt.responsive){$(window).on("resize.flex"+this.internalId,this.doRezise)}},dragEvents:function(){var l=this;var m;var n;var o;var p=this.wrapperHolder.hammer({drag_min_distance:1});p.on("dragstart",function(a){n=t}).on("drag",function(a){if(!l.dragging){if(typeof n=="undefined"){n=!!(n||Math.abs(a.gesture.deltaX)<Math.abs(a.gesture.deltaY));if(!n){a.gesture.preventDefault()}}if($.isFunction(l.opt.beforeDrag)){l.opt.beforeDrag()}l.clearPlay();l.dragging=true;m=l.wrapper.position();if(l.transition){l.wrapper.css(l.transitionName,"")}else{l.wrapper.stop()}if(!l.isTouch){l.wrapperHolder.addClass("dragging");l.wrapperHolder.css("cursor",l.wrapperHolder.css("cursor"))}o=a.target||a.srcElement}else{if(typeof n=="undefined"){n=!!(n||Math.abs(a.gesture.deltaX)<Math.abs(a.gesture.deltaY))}if((!n&&a.gesture.pointerType=="touch")||a.gesture.pointerType=="mouse"){a.gesture.preventDefault();var b=0.6;var c;if(m.left>0||m.left<-l.maxTransLeft){c=a.gesture.deltaX*b+m.left}else{c=a.gesture.deltaX+m.left}if(c<-l.maxTransLeft){if(m.left<-l.maxTransLeft){c=m.left+a.gesture.deltaX*b}else{c=-l.maxTransLeft+(c-(-l.maxTransLeft))*b}}if(c>0){if(m.left>0){c=m.left+a.gesture.deltaX*b}else{c=c*b}}l.dragEndX=c;l.moveTo(c)}}}).on("dragend",function(e){var f=e.target||e.srcElement;if($(o).is($(f))&&!l.isTouch){$(o).on("click.flex-disableclick",function(a){a.stopImmediatePropagation();a.stopPropagation();a.preventDefault();$(o).off("click.flex-disableclick");return false});var g=$._data(o,"events");g.click.unshift(g.click.pop())}e.gesture.preventDefault();if(e.gesture.pointerType=="touch"&&n){return}e.gesture.preventDefault();l.dragging=false;var h=l.opt.scrollPerPage?l.pagePositions:l.itemPositions;var i;if(l.dragEndX<-l.maxTransLeft){i=l.itemPositions.length-1}else if(l.dragEndX>0){i=0}else{var j=0.1;var k=j*l.itemWidth;$.each(h,function(a,b){var c=h[a-1]===t?Number.MAX_VALUE:h[a-1];var d=h[a+1]===t?-Number.MAX_VALUE:h[a+1];if(e.gesture.deltaX<0&&l.dragEndX>=b-k&&l.dragEndX<c-k){if(l.opt.scrollPerPage){i=$.inArray(b,l.itemPositions)}else{i=a}}if(e.gesture.deltaX>0&&l.dragEndX>=d+k&&l.dragEndX<=b+k){if(l.opt.scrollPerPage){i=$.inArray(b,l.itemPositions)}else{i=a}}})}if(!l.isTouch){l.wrapperHolder.removeClass("dragging");l.wrapperHolder.css("cursor","")}if($.isFunction(l.opt.afterDrag)){l.opt.afterDrag()}l.goTo(i,l.opt.slideSpeed,true)})},swapEvents:function(){var a=this;var b=Hammer(this.wrapperHolder.get(0),{swipe_velocity:0.1});b.on("swipeleft swiperight",function(e){e.gesture.preventDefault();if(e.type=="dragleft"||e.type=="dragright"){return}if(e.type=="swipeleft"){a.next()}else{a.prev()}})},loadEvents:function(){var a=this;if(this.opt.responsive){this.resizeHandler()}if(this.opt.drag){this.dragEvents()}else{this.swapEvents()}if(this.opt.pauseOnHover&&!this.isTouch){this.pauseOnHover()}if(this.opt.mouseWheel){this.container.on("mousewheel.flex",function(e){e.stopPropagation();e.preventDefault();if(e.deltaY<0){a.next()}if(e.deltaY>0){a.prev()}})}if(this.opt.lazyLoad){this.lazyLoadImage()}},moveTo:function(a){var b={};b[this.moveProperty]=this.moveValueMarkup.replace("{0}",a);this.wrapper.css(b);if(this.needCheckVisible){this.checkVisible(a)}},slideTo:function(a,b){var c=this;if(this.transition){this.isSliding=true;this.wrapper.css(this.transitionName,"all "+b+"ms cubic-bezier(0.215, 0.61, 0.355, 1)");this.moveTo(a);this.wrapper.one(this.transEndName,function(){c.isSliding=false});this.emulateTransitionEnd(this.wrapper,b+50)}else{this.wrapper.stop().animate({"left":a},b,function(){c.isSliding=false})}},goTo:function(a,b,c){if(b===t){b=this.opt.slideSpeed}if(c===t){c=true}if(a<0){a=0}if(a>this.maxTransItems){a=this.maxTransItems}if(c){this.slideTo(Math.round(this.itemPositions[a]),b);if(this.needCheckVisible){this.checkVisible(this.itemPositions[a])}}else{if(this.transition){this.wrapper.css(this.transitionName,"")}this.moveTo(Math.round(this.itemPositions[a]))}if(a!=this.showIndex&&$.isFunction(this.opt.indexChanged)){this.opt.indexChanged(a)}this.showIndex=a;this.afterGo()},toStart:function(){this.goTo(0)},toEnd:function(){this.goTo(this.maxTransItems)},afterGo:function(){this.checkPagination();this.checkNavigation();this.resumePlay()},prev:function(){var a;if(this.opt.scrollPerPage){a=this.pageIndex-1;if(this.opt.rewind&&a<0){a=this.pageIndexs.length-1}else if(!this.opt.rewind&&a<0){return false}this.goTo(this.pageIndexs[a],this.opt.slideSpeed,true)}else{a=this.showIndex-1;if(this.opt.rewind&&a<0){a=this.maxTransItems}else if(!this.opt.rewind&&a<0){return false}this.goTo(a,this.opt.slideSpeed,true)}},next:function(){var a;if(this.opt.scrollPerPage){a=this.pageIndex+1;if(this.opt.rewind&&a>this.pageIndexs.length-1){a=0}else if(!this.opt.rewind&&a>this.pageIndexs.length-1){return false}this.goTo(this.pageIndexs[a],this.opt.slideSpeed,true)}else{a=this.showIndex+1;if(this.opt.rewind&&a>this.maxTransItems){a=0}else if(!this.opt.rewind&&a>this.maxTransItems){return false}this.goTo(a,this.opt.slideSpeed,true)}},play:function(){var a=this;this.playStatus="play";window.clearInterval(this.playTimer);this.playTimer=window.setInterval(function(){a.next()},this.opt.interval)},stop:function(){this.playStatus="stop";window.clearInterval(this.playTimer)},resumePlay:function(){if(this.playStatus!=="stop"){this.play()}},clearPlay:function(){window.clearInterval(this.playTimer)},pauseOnHover:function(){var a=this;this.container.on("mouseenter.flex",function(){a.playStatusBeforeHover=a.playStatus;if(a.playStatus==="play"){a.stop()}});this.container.on("mouseleave.flex",function(){if(a.playStatusBeforeHover==="play"){if(a.dragging){a.playStatus="play"}else{a.play()}}})},checkVisible:function(x){var b=this.itemWidth-this.itemPad;var c=[];for(var i=0;i<this.userItemPositions.length;i++){if(this.userItemPositions[i]>(x-this.holderWidth)&&this.userItemPositions[i]<=x||(this.userItemPositions[i]-b)>=(x-this.holderWidth)&&(this.userItemPositions[i]-b)<x){c.push(i)}}var d=this.items.filter(function(a){return $.inArray(a,c)>=0});if(this.doAnimation){d.addClass(this.opt.itemAnimation);this.items.not(d).removeClass(this.opt.itemAnimation)}if(this.opt.lazyLoad){var e=d.find(this.lazyImages).trigger("flexlazy");this.lazyImages=this.lazyImages.not(e)}},lazyLoadImage:function(){var b=this;b.lazyImages.one("flexlazy",function(){var a=this.getAttribute("data-src");this.setAttribute("src",a);this.removeAttribute("data-src")})},destroy:function(){if(this.pagination){this.pagination.remove()}if(this.navigation){this.navigation.remove()}this.items.unwrap().unwrap().unwrap();$(window).off("resize.flex"+this.internalId);this.container.attr("class",this.originalClass).removeData("flexCarousel")},};var s=$(this);return this.each(function(){objCarousel=new FlexCarousel($(this),q)})}})})(jQuery);